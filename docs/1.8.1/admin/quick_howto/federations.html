

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configure Federations &mdash; Traffic Control 1.8-dev documentation </title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Traffic Control 1.8-dev documentation" href="../../index.html"/>
        <link rel="up" title="Quick How To Guides" href="index.html"/>
        <link rel="next" title="Configure Regional Geo-blocking (RGB)" href="regionalgeo.html"/>
        <link rel="prev" title="Configure DNSSEC" href="dnssec.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="/" class="icon icon-home"> Traffic Control
        

        
          
          <img src="../../_static/tc_logo.png" class="logo" />
        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../basics/index.html">CDN Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../basics/content_delivery_networks.html">Content Delivery Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/http_11.html">HTTP 1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/caching_proxies.html">Caching Proxies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basics/cache_revalidation.html">Cache Control Headers and Revalidation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Traffic Control Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../overview/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/traffic_ops.html">Traffic Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/traffic_portal.html">Traffic Portal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/traffic_router.html">Traffic Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/traffic_monitor.html">Traffic Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/traffic_stats.html">Traffic Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/traffic_server.html">Traffic Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../overview/traffic_vault.html">Traffic Vault</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administrator’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../traffic_ops_install.html">Installing Traffic Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_ops_config.html">Configuring Traffic Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_ops_using.html">Using Traffic Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_ops_extensions.html">Managing Traffic Ops Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_portal.html">Traffic Portal Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_monitor.html">Traffic Monitor Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_router.html">Traffic Router Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_stats.html">Traffic Stats Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_server.html">Traffic Server Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_vault.html">Traffic Vault Administration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Quick How To Guides</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer’s Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/traffic_ops.html">Traffic Ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/traffic_portal.html">Traffic Portal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/traffic_router.html">Traffic Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/traffic_monitor.html">Traffic Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/traffic_stats.html">Traffic Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/traffic_server.html">Traffic Server</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../faq/general.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/development.html">Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/administration.html">Running a Traffic Control CDN</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Traffic Control</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Traffic Control 1.8-dev</a> &raquo;</li>
      
          <li><a href="../index.html">Administrator’s Guide</a> &raquo;</li>
      
          <li><a href="index.html">Quick How To Guides</a> &raquo;</li>
      
    <li>Configure Federations</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../_sources/admin/quick_howto/federations.rst.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
 		  
    		  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      		  
        		  <a href="regionalgeo.html" class="btn btn-neutral float-right" title="Configure Regional Geo-blocking (RGB)">Next <span class="fa fa-arrow-circle-right"></span></a>
      		  
      		  
        		  <a href="dnssec.html" class="btn btn-neutral" title="Configure DNSSEC"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      		  
    		  </div>
  		  
          <div role="main" class="document">
            
  <div class="section" id="configure-federations">
<span id="rl-federations-qht"></span><h1>Configure Federations<a class="headerlink" href="#configure-federations" title="Permalink to this headline">¶</a></h1>
<ol class="arabic">
<li><p class="first">Create a user with a federations role (Misc -&gt; Users -&gt; Add User).  This user will have the ability to perform the following actions:</p>
<blockquote>
<div><ul class="simple">
<li>Edit the federation</li>
<li>Delete the federation</li>
<li>Add IPV4 resolvers</li>
<li>Add IPV6 resolvers</li>
</ul>
</div></blockquote>
</li>
</ol>
<a class="reference internal image-reference" href="../../_images/federation01.png"><img alt="../../_images/federation01.png" class="align-center" src="../../_images/federation01.png" style="width: 804.0px; height: 690.0px;" /></a>
<ol class="arabic simple" start="2">
<li>As a user with admin priveleges, create a Federation Mapping by going to Delivery Services -&gt; Federations and then clicking ‘Add Federation Mapping’</li>
<li>Choose the Delivery Service for the federation to be mapped to and assign it to the Federation User; click Add.</li>
</ol>
<a class="reference internal image-reference" href="../../_images/federation02.png"><img alt="../../_images/federation02.png" class="align-center" src="../../_images/federation02.png" style="width: 766.0px; height: 494.0px;" /></a>
<ol class="arabic" start="4">
<li><p class="first">After the Federation is added, Traffic Ops will display the Federation.</p>
<p>Changes can be made at this time or the Federation can be deleted.  Notice that no resolvers have been added to the fedeation yet.  This can only be done by the federation user created in step 1.</p>
<p>If no further action is necessary, the Close button will close the window and display the list of all Federations.</p>
</li>
</ol>
<a class="reference internal image-reference" href="../../_images/federation03.png"><img alt="../../_images/federation03.png" class="align-center" src="../../_images/federation03.png" style="width: 806.0px; height: 886.0px;" /></a>
<p><strong>The Federation user can now add resolvers to the Federation Mapping in Traffic Ops.</strong></p>
<ol class="arabic" start="5">
<li><p class="first">The federation user logs to traffic ops and stores the mojolicious cookie.  The mojolicious cookie can be obtained manually using the debug tools on a web browser or via curl.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ curl -i -XPOST &quot;http://localhost:3000/api/1.1/user/login&quot; -H &quot;Content-Type: application/json&quot; -d &#39;{ &quot;u&quot;: &quot;federation_user1&quot;, &quot;p&quot;: &quot;password&quot; }&#39;

HTTP/1.1 200 OK
Date: Wed, 02 Dec 2015 21:12:06 GMT
Content-Length: 65
Access-Control-Allow-Credentials: true
Content-Type: application/json
Access-Control-Allow-Methods: POST,GET,OPTIONS,PUT,DELETE
Set-Cookie: mojolicious=eyJleHBpcmVzIjoxNDQ5MTA1MTI2LCJhdXRoX2RhdGEiOiJmZWRlcmF0aW9uX3VzZXIxIn0---06b4f870d809d82a91433e92eae8320875c3e8b0; expires=Thu, 03 Dec 2015 01:12:06 GMT; path=/; HttpOnly
Server: Mojolicious (Perl)
Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Connection: keep-alive
Access-Control-Allow-Origin: http://localhost:8080

{&quot;alerts&quot;:[{&quot;level&quot;:&quot;success&quot;,&quot;text&quot;:&quot;Successfully logged in.&quot;}]}
</pre></div>
</div>
</li>
<li><p class="first">The federation user sends a request to Traffic Ops to add IPV4 and/or IPV6 resolvers</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ curl -ki -H &quot;Cookie: mojolicious=eyJleHBpcmVzIjoxNDQ5MTA1MTI2LCJhdXRoX2RhdGEiOiJmZWRlcmF0aW9uX3VzZXIxIn0---06b4f870d809d82a91433e92eae8320875c3e8b0;&quot; -XPUT &#39;http://localhost:3000/api/1.2/federations&#39; -d &#39;
        {&quot;federations&quot;: [
                {   &quot;deliveryService&quot;: &quot;images-c1&quot;,
                        &quot;mappings&quot;:
                                { &quot;resolve4&quot;: [ &quot;8.8.8.8/32&quot;, &quot;8.8.4.4/32&quot; ],
                                  &quot;resolve6&quot;: [&quot;2001:4860:4860::8888/128&quot;, &quot;2001:4860:4860::8844&quot;]
                                }
                }
          ]
        }&#39;

HTTP/1.1 200 OK
Set-Cookie: mojolicious=eyJleHBpcmVzIjoxNDQ5MTA1OTQyLCJhdXRoX2RhdGEiOiJmZWRlcmF0aW9uX3VzZXIxIn0---b42be0749415cefd1d14e1a91bb214845b4de556; expires=Thu, 03 Dec 2015 01:25:42 GMT; path=/; HttpOnly
Server: Mojolicious (Perl)
Date: Wed, 02 Dec 2015 21:25:42 GMT
Content-Length: 74
Access-Control-Allow-Credentials: true
Content-Type: application/json
Access-Control-Allow-Methods: POST,GET,OPTIONS,PUT,DELETE
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Access-Control-Allow-Origin: http://localhost:8080
Connection: keep-alive
Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept

{&quot;response&quot;:&quot;federation_user1 successfully created federation resolvers.&quot;}
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">The resolvers added by the federation user will now visible in Traffic Ops.</p>
</li>
</ol>
<a class="reference internal image-reference" href="../../_images/federation04.png"><img alt="../../_images/federation04.png" class="align-center" src="../../_images/federation04.png" style="width: 802.0px; height: 875.0px;" /></a>
<ol class="arabic" start="8">
<li><p class="first">Any requests made from a client that resolves to one of the federation resolvers will now be given a CNAME from Traffic Router.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ dig @tr.kabletown.net edge.images-c1.kabletown.net

; &lt;&lt;&gt;&gt; DiG 9.7.3-RedHat-9.7.3-2.el6 &lt;&lt;&gt;&gt; @tr.kabletown.net edge.images-c1.kabletown.net
; (1 server found)
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 45110
;; flags: qr rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; WARNING: recursion requested but not available

;; QUESTION SECTION:
;edge.images-c1.kabletown.net.  IN A

;; ANSWER SECTION:
edge.images-c1.kabletown.net.   30 IN CNAME img.mega-cdn.net.

;; Query time: 9 msec
;; SERVER: 10.10.10.10#53(10.10.10.10)
;; WHEN: Wed Dec  2 22:05:26 2015
;; MSG SIZE  rcvd: 84
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="regionalgeo.html" class="btn btn-neutral float-right" title="Configure Regional Geo-blocking (RGB)">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dnssec.html" class="btn btn-neutral" title="Configure DNSSEC"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.8-dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>